<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.health.agent.module.knowledge.mapper.KnowledgeBaseMapper">

    <resultMap id="KnowledgeBaseResultMap" type="com.health.agent.module.knowledge.entity.KnowledgeBase">
        <id column="id" property="id"/>
        <result column="name" property="name"/>
        <result column="description" property="description"/>
        <result column="vector_db_type" property="vectorDbType"/>
        <result column="chunk_size" property="chunkSize"/>
        <result column="chunk_overlap" property="chunkOverlap"/>
        <result column="created_at" property="createdAt"/>
        <result column="updated_at" property="updatedAt"/>
    </resultMap>

    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO knowledge_base
        (name, description, vector_db_type, chunk_size, chunk_overlap)
        VALUES
        (#{name}, #{description}, #{vectorDbType}, #{chunkSize}, #{chunkOverlap})
    </insert>

    <select id="selectAll" resultMap="KnowledgeBaseResultMap">
        SELECT * FROM knowledge_base ORDER BY created_at DESC
    </select>

    <select id="selectById" resultMap="KnowledgeBaseResultMap">
        SELECT * FROM knowledge_base WHERE id = #{id}
    </select>

    <select id="countByIds" resultType="long">
        SELECT COUNT(1) FROM knowledge_base WHERE id IN
        <foreach collection="ids" item="id" open="(" close=")" separator=",">
            #{id}
        </foreach>
    </select>

</mapper>

